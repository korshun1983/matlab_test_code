% Rotate elastic matrix 

% c11 c13 c33 c44 c66 angle
cij_input = [ 40.9 , 8.5 , 26.9 , 10.5 , 15.3 , -pi/2, 0];


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%     
% c11 c13 c33 c44 c66     
% C_VTI=[C11 C12 C13 0 0 0; C12 C11 C13 0 0 0; C13 C13 C33 0 0 0; 0 0 0 C44 0 0; 0 0 0 0 C44 0; 0 0 0 0 0 C66];
c_ij = zeros(6,6);
c_ij(1,1) = cij_input(1);
c_ij(2,2) = cij_input(1);
c_ij(3,3) = cij_input(3);

c_ij(4,4) = cij_input(4);
c_ij(5,5) = cij_input(4);
c_ij(6,6) = cij_input(5);

c_ij(1,2) = c_ij(1,1) - 2*c_ij(6,6);
c_ij(1,3) = cij_input(2);
c_ij(2,3) = cij_input(2);

c_ij(2,1) = c_ij(1,2);
c_ij(3,1) = c_ij(1,3);
c_ij(3,2) = c_ij(2,3);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
theta=cij_input(6); phi=cij_input(7); 
a_rot = [ cos(phi)                sin(phi)                0;...
         -cos(theta)*sin(phi)    cos(theta)*cos(phi)     sin(theta);...
          sin(theta)*sin(phi)   -sin(theta)*cos(phi)     cos(theta)];
a=a_rot;
      
Mincl = [a(1,1)^2, a(1,2)^2, a(1,3)^2, 2*a(1,2)*a(1,3), 2*a(1,1)*a(1,3), 2*a(1,1)*a(1,2);...
         a(2,1)^2, a(2,2)^2, a(2,3)^2, 2*a(2,2)*a(2,3), 2*a(2,1)*a(2,3), 2*a(2,1)*a(2,2);...
         a(3,1)^2, a(3,2)^2, a(3,3)^2, 2*a(3,2)*a(3,3), 2*a(3,1)*a(3,3), 2*a(3,1)*a(3,2);...
         a(2,1)*a(3,1), a(2,2)*a(3,2), a(2,3)*a(3,3), a(2,2)*a(3,3) + a(2,3)*a(3,2), a(2,1)*a(3,3) + a(2,3)*a(3,1), a(2,1)*a(3,2) + a(2,2)*a(3,1);...
         a(1,1)*a(3,1), a(1,2)*a(3,2), a(1,3)*a(3,3), a(1,2)*a(3,3) + a(1,3)*a(3,2), a(1,1)*a(3,3) + a(1,3)*a(3,1), a(1,1)*a(3,2) + a(1,2)*a(3,1);...
         a(1,1)*a(2,1), a(1,2)*a(2,2), a(1,3)*a(2,3), a(1,2)*a(2,3) + a(1,3)*a(2,2), a(1,1)*a(2,3) + a(1,3)*a(2,1), a(1,1)*a(2,2) + a(1,2)*a(2,1) ]; 

DD = (Mincl*c_ij)*(Mincl');
DD

OO=zeros(21,1);
OO(1) =DD(1,1); OO(2) =DD(1,2); OO(3) =DD(2,2); OO(4) =DD(1,3); OO(5) =DD(2,3); OO(6) =DD(3,3);
OO(7) =DD(1,4); OO(8) =DD(2,4); OO(9) =DD(3,4); OO(10) =DD(4,4);
OO(11)=DD(1,5); OO(12)=DD(2,5); OO(13)=DD(3,5); OO(14)=DD(4,5); OO(15)=DD(5,5);
OO(16)=DD(1,6); OO(17)=DD(2,6); OO(18)=DD(3,6); OO(19)=DD(4,6); OO(20)=DD(5,6); OO(21)=DD(6,6);

fprintf(1,'{');
for ii=1:21
    fprintf(1,'%.3e [Pa]',OO(ii)*1e9);
    if ii~=21, fprintf(1,','); end
end
fprintf(1,'}\n');

zzz=1;

